# 6、什么情况下 mysql 会索引失效

**失效条件：**

● where 后面使用函数

● 使用or 条件

● 模糊查询%放在前边

● 类型转换

组合索引（最佳左前缀匹配原则）

<font style="color:rgb(144,159,174);">#查询条件用到了计算或者函数</font>

<font style="color:rgb(0,119,170);">e</font><font style="color:rgb(0,119,170);">x</font><font style="color:rgb(0,119,170);">p</font><font style="color:rgb(0,119,170);">l</font><font style="color:rgb(0,119,170);">a</font><font style="color:rgb(0,119,170);">i</font><font style="color:rgb(0,119,170);">n</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(0,119,170);">S</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">C</font><font style="color:rgb(0,119,170);">T</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(154,109,57);">*</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(0,119,170);">f</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">o</font><font style="color:rgb(0,119,170);">m</font><font style="color:rgb(0,119,170);"> </font>test_slow_query <font style="color:rgb(0,119,170);">w</font><font style="color:rgb(0,119,170);">he</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">e</font><font style="color:rgb(0,119,170);"> </font>age <font style="color:rgb(154,109,57);">=</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(153,0,84);">2</font><font style="color:rgb(153,0,84);">0 </font><font style="color:rgb(0,119,170);">e</font><font style="color:rgb(0,119,170);">x</font><font style="color:rgb(0,119,170);">p</font><font style="color:rgb(0,119,170);">l</font><font style="color:rgb(0,119,170);">a</font><font style="color:rgb(0,119,170);">i</font><font style="color:rgb(0,119,170);">n</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(0,119,170);">S</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">C</font><font style="color:rgb(0,119,170);">T</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(154,109,57);">*</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(0,119,170);">f</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">o</font><font style="color:rgb(0,119,170);">m</font><font style="color:rgb(0,119,170);"> </font>test_slow_query <font style="color:rgb(0,119,170);">w</font><font style="color:rgb(0,119,170);">he</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">e</font><font style="color:rgb(0,119,170);"> </font>age <font style="color:rgb(154,109,57);">+</font><font style="color:rgb(153,0,84);">1</font><font style="color:rgb(153,0,84);">0</font><font style="color:rgb(153,0,84);"> </font><font style="color:rgb(154,109,57);">=</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(153,0,84);">3</font><font style="color:rgb(153,0,84);">0</font>

<font style="color:rgb(144,159,174);">#模糊查询</font>

<font style="color:rgb(0,119,170);">EX</font><font style="color:rgb(0,119,170);">P</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">A</font><font style="color:rgb(0,119,170);">I</font><font style="color:rgb(0,119,170);">N</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(0,119,170);">S</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">C</font><font style="color:rgb(0,119,170);">T</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(154,109,57);">*</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(0,119,170);">f</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">o</font><font style="color:rgb(0,119,170);">m</font><font style="color:rgb(0,119,170);"> </font>test_slow_query <font style="color:rgb(0,119,170);">w</font><font style="color:rgb(0,119,170);">he</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">e</font><font style="color:rgb(0,119,170);"> </font>NAME <font style="color:rgb(154,109,57);">l</font><font style="color:rgb(154,109,57);">i</font><font style="color:rgb(154,109,57);">k</font><font style="color:rgb(154,109,57);">e</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(102,153,0);">'</font><font style="color:rgb(102,153,0);">%</font><font style="color:rgb(102,153,0);">吕布</font><font style="color:rgb(102,153,0);">' </font><font style="color:rgb(0,119,170);">EX</font><font style="color:rgb(0,119,170);">P</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">A</font><font style="color:rgb(0,119,170);">I</font><font style="color:rgb(0,119,170);">N</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(0,119,170);">S</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">C</font><font style="color:rgb(0,119,170);">T</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(154,109,57);">*</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(0,119,170);">f</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">o</font><font style="color:rgb(0,119,170);">m</font><font style="color:rgb(0,119,170);"> </font>test_slow_query <font style="color:rgb(0,119,170);">w</font><font style="color:rgb(0,119,170);">he</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">e</font><font style="color:rgb(0,119,170);"> </font>NAME <font style="color:rgb(154,109,57);">l</font><font style="color:rgb(154,109,57);">i</font><font style="color:rgb(154,109,57);">k</font><font style="color:rgb(154,109,57);">e</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(102,153,0);">'</font><font style="color:rgb(102,153,0);">%</font><font style="color:rgb(102,153,0);">吕布</font><font style="color:rgb(102,153,0);">%</font><font style="color:rgb(102,153,0);">' </font><font style="color:rgb(0,119,170);">EX</font><font style="color:rgb(0,119,170);">P</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">A</font><font style="color:rgb(0,119,170);">I</font><font style="color:rgb(0,119,170);">N</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(0,119,170);">S</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">C</font><font style="color:rgb(0,119,170);">T</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(154,109,57);">*</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(0,119,170);">f</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">o</font><font style="color:rgb(0,119,170);">m</font><font style="color:rgb(0,119,170);"> </font>test_slow_query <font style="color:rgb(0,119,170);">w</font><font style="color:rgb(0,119,170);">he</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">e</font><font style="color:rgb(0,119,170);"> </font>NAME <font style="color:rgb(154,109,57);">l</font><font style="color:rgb(154,109,57);">i</font><font style="color:rgb(154,109,57);">k</font><font style="color:rgb(154,109,57);">e</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(102,153,0);">'</font><font style="color:rgb(102,153,0);">吕布</font><font style="color:rgb(102,153,0);">&</font><font style="color:rgb(102,153,0);">'</font>

<font style="color:rgb(144,159,174);">#用到了</font><font style="color:rgb(144,159,174);">or</font><font style="color:rgb(144,159,174);"> </font><font style="color:rgb(144,159,174);">条件</font>

<font style="color:rgb(0,119,170);">EX</font><font style="color:rgb(0,119,170);">P</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">A</font><font style="color:rgb(0,119,170);">I</font><font style="color:rgb(0,119,170);">N</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(0,119,170);">S</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">L</font><font style="color:rgb(0,119,170);">E</font><font style="color:rgb(0,119,170);">C</font><font style="color:rgb(0,119,170);">T</font><font style="color:rgb(0,119,170);"> </font><font style="color:rgb(154,109,57);">*</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(0,119,170);">f</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">o</font><font style="color:rgb(0,119,170);">m</font><font style="color:rgb(0,119,170);"> </font>test_slow_query <font style="color:rgb(0,119,170);">w</font><font style="color:rgb(0,119,170);">he</font><font style="color:rgb(0,119,170);">r</font><font style="color:rgb(0,119,170);">e</font><font style="color:rgb(0,119,170);"> </font>NAME <font style="color:rgb(154,109,57);">=</font><font style="color:rgb(154,109,57);"> </font><font style="color:rgb(102,153,0);">'</font><font style="color:rgb(102,153,0);">吕布</font><font style="color:rgb(102,153,0);">'</font><font style="color:rgb(102,153,0);"> </font><font style="color:rgb(154,109,57);">o</font><font style="color:rgb(154,109,57);">r</font><font style="color:rgb(154,109,57);"> </font>name <font style="color:rgb(154,109,57);">= </font><font style="color:rgb(102,153,0);">"aaa"</font>

<font style="color:rgb(144,159,174);">#类型不匹配查询</font>

<font style="color:rgb(0,119,170);">explain SELECT </font><font style="color:rgb(154,109,57);">*</font><font style="color:rgb(0,119,170);">from </font>test_slow_query <font style="color:rgb(0,119,170);">where </font>NAME <font style="color:rgb(154,109,57);">= </font><font style="color:rgb(153,0,84);">11 </font><font style="color:rgb(0,119,170);">explain SELECT </font><font style="color:rgb(154,109,57);">* </font><font style="color:rgb(0,119,170);">from </font>test_slow_query <font style="color:rgb(0,119,170);">where </font>NAME <font style="color:rgb(154,109,57);">= </font><font style="color:rgb(102,153,0);">'11'</font>

> 更新: 2024-05-01 16:18:12  
